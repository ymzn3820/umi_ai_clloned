(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-index"],{"0638":function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}));var n={uIcon:i("fd47").default,uPopup:i("7623").default,uTextarea:i("9800").default,"u-Input":i("0724").default},o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticStyle:{background:"#F6F8FB"},attrs:{id:"pag_top"}},[i("v-uni-view",{staticClass:"container-fill"},[i("v-uni-view",{staticClass:"scroll-fullpage"},[i("v-uni-view",{staticClass:"digital a1",style:{height:e.windowHeight+"px",marginTop:e.keyHeight+"px"}},[1==e.isSpeak?i("v-uni-view",[i("v-uni-image",{staticClass:"video_w",style:{"z-index":e.img_index},attrs:{src:e.nospeak,mode:"aspectFill"}}),i("v-uni-video",{staticClass:"video_w",style:{"z-index":e.no_index},attrs:{src:e.nospeak1,muted:!0,id:"noVideo",loop:!0,controls:!0,"show-fullscreen-btn":!1,"show-center-play-btn":!1,objectFit:"cover","http-cache":!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.playVideo.apply(void 0,arguments)}}}),i("v-uni-video",{staticClass:"video_w",style:{"z-index":e.y_index},attrs:{src:e.speak1,id:"myVideo",controls:!1,"show-fullscreen-btn":!1,"show-center-play-btn":!1,objectFit:"cover","http-cache":!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.playOne.apply(void 0,arguments)},ended:function(t){arguments[0]=t=e.$handleEvent(t),e.oneEnd.apply(void 0,arguments)}}})],1):e._e(),2==e.isSpeak?i("v-uni-view",[i("v-uni-image",{staticClass:"video_w",style:{"z-index":e.img_index},attrs:{src:e.getImgUrl(e.infoSpeak.out_video_cover),mode:"aspectFill"}}),i("v-uni-video",{staticClass:"video_w",style:{"z-index":e.no_index},attrs:{src:e.getImgUrl(e.infoSpeak.out_video),muted:!0,id:"noVideo",loop:!0,controls:!1,"show-fullscreen-btn":!1,objectFit:"cover","http-cache":!0,"show-center-play-btn":!1},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.playSpeak.apply(void 0,arguments)}}}),i("v-uni-video",{staticClass:"video_w",style:{"z-index":e.y_index},attrs:{src:e.getImgUrl(e.infoSpeak.out_video_speak),muted:!0,loop:!0,id:"myVideo",controls:!1,"show-fullscreen-btn":!1,objectFit:"cover","http-cache":!0,"show-center-play-btn":!1},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.speakOne.apply(void 0,arguments)}}})],1):e._e(),2==e.isSpeak?i("v-uni-view",{staticClass:"top-nav"},[e.infoSpeak.user_mobile?i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toPhone(e.infoSpeak.user_mobile)}}},[i("v-uni-image",{attrs:{src:e.phoneImg}}),i("v-uni-text",[e._v("电话")])],1):e._e(),e.infoSpeak.wechat_code?i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.checkInfo(1)}}},[i("v-uni-image",{attrs:{src:e.wxImg}}),i("v-uni-text",[e._v("微信")])],1):e._e(),e.infoSpeak.group_code?i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.checkInfo(2)}}},[i("v-uni-image",{attrs:{src:e.wxgImg}}),i("v-uni-text",[e._v("微信群")])],1):e._e(),e.infoSpeak.model_website?i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.checkInfo(3)}}},[i("v-uni-image",{attrs:{src:e.webImg}}),i("v-uni-text",[e._v("网址")])],1):e._e(),e.temp_id?i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.message()}}},[i("u-icon",{attrs:{name:"chat",size:"21",color:"#FFF"}}),i("v-uni-text",[e._v("留言")])],1):e._e()],1):e._e(),i("v-uni-view",{staticClass:"right-nav"},[i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toDigital(0)}}},[i("v-uni-image",{attrs:{src:e.tabImg5}}),i("v-uni-text",[e._v("创建形象")])],1),i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toDigital(1)}}},[i("v-uni-image",{attrs:{src:e.tabImg1}}),i("v-uni-text",[e._v("我的分身")])],1),""!=e.infoSpeak?i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toDigital(2)}}},[i("v-uni-image",{attrs:{src:e.tabImg2}}),i("v-uni-text",[e._v("去对话")])],1):e._e(),""==e.infoSpeak||e.temp_id?e._e():i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toDigital(3)}}},[i("v-uni-image",{attrs:{src:e.tabImg3}}),i("v-uni-text",[e._v("分享")])],1),""==e.infoSpeak||e.temp_id?e._e():i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toDigital(4)}}},[i("v-uni-image",{attrs:{src:e.tabImg4}}),i("v-uni-text",[e._v("记录")])],1)],1)],1),i("u-popup",{attrs:{show:e.messageShow,mode:"center",round:8,length:"auto"}},[i("v-uni-view",{staticClass:"message-box"},[i("v-uni-view",{staticClass:"message-close",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.messageShow=!1}}},[i("u-icon",{attrs:{name:"close",size:"21"}})],1),i("v-uni-view",{staticClass:"message-title"},[e._v("留言")]),i("v-uni-view",{staticClass:"message-content"},[i("u-textarea",{attrs:{placeholder:"请输入你想留言的内容",maxlength:"-1"},model:{value:e.messageValue,callback:function(t){e.messageValue=t},expression:"messageValue"}}),i("v-uni-view",{staticClass:"phone_title"},[e._v("联系方式")]),i("u--input",{attrs:{placeholder:"请输入手机号码",border:"surround",maxlength:"30"},model:{value:e.messagePhone,callback:function(t){e.messagePhone=t},expression:"messagePhone"}}),i("v-uni-view",{staticClass:"message-submit",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.messageSubmit.apply(void 0,arguments)}}},[e._v("提交")])],1)],1)],1),i("u-popup",{attrs:{show:e.tipShow,mode:"center",round:8,length:"auto"}},[i("v-uni-view",{staticClass:"message-box"},[i("v-uni-view",{staticClass:"message-close",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.tipShow=!1}}},[i("u-icon",{attrs:{name:"close",size:"21"}})],1),1==e.top_tip?i("v-uni-view",{staticClass:"message-content"},[i("v-uni-image",{staticStyle:{width:"100%"},attrs:{src:e.getImgUrl(e.infoSpeak.wechat_code),mode:"aspectFit"}})],1):e._e(),2==e.top_tip?i("v-uni-view",{staticClass:"message-content"},[i("v-uni-image",{staticStyle:{width:"100%"},attrs:{src:e.getImgUrl(e.infoSpeak.group_code),mode:"aspectFit"}})],1):e._e(),3==e.top_tip?i("v-uni-view",{staticClass:"message-content"},[i("v-uni-view",{staticStyle:{"margin-top":"40rpx","text-align":"center"}},[e._v(e._s(e.infoSpeak.model_website))]),i("v-uni-view",{staticClass:"message-submit",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.copyWebsite(e.infoSpeak.model_website)}}},[e._v("复制")])],1):e._e()],1)],1)],1)],1)],1)},a=[]},3674:function(e,t,i){"use strict";i.r(t);var n=i("9412"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a},"6e40":function(e,t,i){var n=i("ebbf");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=i("4f06").default;o("ae4e48d8",n,!0,{sourceMap:!1,shadowMode:!1})},"848c":function(e,t,i){"use strict";var n=i("f40b"),o=i.n(n);o.a},"8b42":function(e,t,i){"use strict";var n=i("6e40"),o=i.n(n);o.a},9412:function(e,t,i){"use strict";(function(e){i("7a82");var n=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("e9c4"),i("c975"),i("d3b7"),i("159b"),i("ac1f");var o,a=n(i("ade3")),s=n(i("53ca")),c=n(i("c7eb")),d=n(i("1da1")),l=i("27e6"),u=i("6673"),r=i("ab3b"),g=(o={data:function(){return{starty_digital:0,endy_digital:0,scrollindex:0,windowHeight:"100vh",phoneImg:e.baseImg+"/xcx/com/message_center/Frame 427321012.png",wxImg:e.baseImg+"/xcx/com/message_center/Frame 427319549.png",wxgImg:e.baseImg+"/xcx/com/message_center/users-group.png",webImg:e.baseImg+"/xcx/com/message_center/web_site.png",tabImg1:e.baseImg+"/xcx/com/message_center/minus-square.png",tabImg2:e.baseImg+"/xcx/com/message_center/消息 1.png",tabImg3:e.baseImg+"/xcx/com/message_center/分享 4.png",tabImg4:e.baseImg+"/xcx/com/message_center/记录 (1).png",tabImg5:e.baseImg+"/xcx/com/message_center/creat.png",keyHeight:0,isTop:!1,nospeak:e.baseImg+"/xcx/com/message_center/renwu.png",nospeak1:e.baseImg+"/xcx/com/message_center/nospeak1.mp4",speak1:e.baseImg+"/xcx/com/message_center/speak.mp4",isone:!0,videoContext_no:"",videoContext:"",infoSpeak:"",token:"",voice_url:"",innerAudioContext:null,noLoad:!0,yLoad:!0,noSpekLoad:!0,ySpeakLoad:!0,nav_title:"AI数字分身",is_click:!1,interact:"",click_count:0,messageShow:!1,messageValue:"",messagePhone:"",temp_id:"",tipShow:!1,top_tip:1,img_index:9,no_index:8,y_index:7,webSocketTask:"",isSpeak:3}},onLoad:function(e){if(e.q){var t=decodeURIComponent(e.q),i=this.getUrlDataFN(t);console.log(i,5566),uni.setStorageSync("loginCode",i);var n=JSON.parse(uni.getStorageSync("userInfo"));"guess"==n.role&&uni.navigateTo({url:"/pages/login/login"})}else if(e.scene){var o=decodeURIComponent(e.scene);this.temp_id=o,this.updateVisit(o)}this.init()},onShow:function(){var t=this;this.videoContext_no=uni.createVideoContext("noVideo"),this.videoContext=uni.createVideoContext("myVideo"),setTimeout((function(){var i=JSON.parse(uni.getStorageSync("userInfo"));console.log(i,5587),"guess"==i.role?(t.headImg=e.baseImg+"/xcx/com/message_center/Frame%20427320149.png",t.isLogin=!1,t.isSpeak=1,t.img_index=8,t.no_index=9,t.y_index=7,setTimeout((function(){t.videoContext_no.play()}),1e3),console.log("进来了")):(t.getModelList(),t.isLogin=!0)}),1e3)},onHide:function(){this.select_text=0,this.current=0}},(0,a.default)(o,"onHide",(function(){})),(0,a.default)(o,"onUnload",(function(){this.stop()})),(0,a.default)(o,"methods",{init:function(){var e=this;this.innerAudioContext=uni.createInnerAudioContext(),this.innerAudioContext.obeyMuteSwitch=!1,this.innerAudioContext.onPlay((function(){console.log("开始播放")})),this.innerAudioContext.onEnded((function(){console.log("播放停止了"),e.videoContext.stop(),e.videoContext_no.play(),e.noSpekLoad=!0,e.img_index=8,e.no_index=9,e.y_index=7})),this.innerAudioContext.onStop((function(e){console.log(e,"出错了111")}))},updateVisit:function(e){var t=this,i={model_id:e};(0,r.updateVisit)(i).then((function(e){2e4==e.code||t.$api.msg(e.msg)})).catch((function(e){t.$api.msg("生成失败")}))},getInteract:function(){var e=this,t={model_id:this.infoSpeak.model_id,question:"",is_click:1};(0,r.getInteract)(t).then((function(t){2e4==t.code?(e.click_count++,1==e.click_count&&e.infoSpeak.share_desc?e.interact=e.infoSpeak.share_desc:2==e.click_count&&e.infoSpeak.model_function?(e.interact=e.infoSpeak.model_function,e.click_count=0):0==e.click_count&&e.infoSpeak.model_greetings?e.interact=e.infoSpeak.model_greetings:e.interact="你好我是数字分身，有什么问题可以向我提问",e.interact?(e.innerAudioContext.stop(),e.getRcordToken()):(e.innerAudioContext.play(),e.videoContext.play())):e.$api.msg(t.msg)})).catch((function(t){e.$api.msg("获取失败")}))},play:function(e){this.innerAudioContext.src=e,this.innerAudioContext.play()},stop:function(){this.innerAudioContext.stop(),this.videoContext.stop(),this.videoContext_no.play(),this.noSpekLoad=!0,this.img_index=8,this.no_index=9,this.y_index=7},getRcordToken:function(){var e=this;return(0,d.default)((0,c.default)().mark((function t(){return(0,c.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,u.getToken)().then((function(t){2e4==t.code?(e.token=t.data.token,e.speakSocket()):e.$api.msg(t.msg)})).catch((function(t){e.$api.msg("获取token失败")}));case 2:case"end":return t.stop()}}),t)})))()},speakSocket:function(){var t=this,i=this;i.webSocketTask=uni.connectSocket({url:"wss://ai.umi6.com:28083/ws/ali/text_to_speech?token="+this.token,header:{"content-type":"application/json"},success:function(e){console.log("成功",e)}}),i.webSocketTask.onOpen((function(e){console.log("监听WebSocket连接打开事件",e),console.log(i.infoSpeak.model_greetings,5548);var t="";t=""!=i.infoSpeak.model_greetings?i.infoSpeak.model_greetings:"你好我是数字分身，有什么问题可以向我提问",i.webSocketTask.send({data:JSON.stringify({text:t,voice:i.infoSpeak.audio_code,action_type:"send"})}),i.webSocketTask.send({data:JSON.stringify({action_type:"stop"})})})),i.webSocketTask.onMessage((function(n){console.log(n,777);var o=(0,s.default)(n.data);if("string"==o){var a=JSON.parse(n.data);if(a){var c=a.data;t.voice_url=e.baseImg+"/"+c,i.webSocketTask.close(),i.webSocketTask.onClose((function(e){console.log("WebSocket 已关闭！")})),t.is_click&&(t.play(t.voice_url),t.videoContext.play(),console.log("准备开始"),t.is_click=!1,t.img_index=8,t.no_index=7,t.y_index=9)}}})),uni.onSocketError((function(e){console.info("监听WebSocket错误"+e)}))},getUrlDataFN:function(e){var t={};if(-1===e.indexOf("?"))return null;var i=e.indexOf("?"),n=e.substr(i+1),o=n.split("&");return o.forEach((function(e){if(-1===e.indexOf("="))t[e]=void 0;else{var i=e.indexOf("="),n=e.substring(0,i),o=e.substr(i+1);t[n]=o}})),t},getInfo:function(){var t=this;(0,l.getUserInfo)().then((function(i){2e4==i.code?(t.userInfo=i.data,t.avatarUrl=e.baseImg+"/"+i.data.avatar_url,t.level=i.data.d_level,uni.setStorageSync("memberInfo",JSON.stringify(i.data)),uni.setStorageSync("avatarUrl",i.data.avatar_url),uni.setStorageSync("level_expire_time",i.data.level_expire_time),"guess"!=t.userInfo.role&&t.serveInfo()):t.$api.msg(i.msg)})).catch((function(e){}))},getModelList:function(){var e=this,t=JSON.parse(uni.getStorageSync("userInfo")),i="",n=this;i=""!=this.temp_id?{user_id:t.user_id,model_id:this.temp_id,is_visitor:1,get_default:0}:{user_id:t.user_id,is_visitor:0,get_default:1},(0,r.getModelList)(i).then((function(t){2e4==t.code?(t.data.length>0?(e.isSpeak=2,e.infoSpeak=t.data[0],e.interact=e.infoSpeak.model_greetings):(e.isSpeak=1,e.infoSpeak=""),setTimeout((function(){n.videoContext_no.play(),e.img_index=8,e.no_index=9,e.y_index=7}),1e3)):e.$api.msg(t.msg)})).catch((function(t){e.$api.msg("获取失败")}))},toDigital:function(e){var t=JSON.parse(uni.getStorageSync("userInfo"));"guess"!=t.role?0==e?uni.navigateTo({url:"/childCont/digital/configuration_image"}):1==e?uni.navigateTo({url:"/childCont/digital/my"}):2==e?uni.navigateTo({url:"/childCont/digital/chat?temp_id="+this.temp_id+"&chatInfo="+JSON.stringify(this.infoSpeak)}):3==e?uni.navigateTo({url:"/childCont/digital/share_digital?model_img="+this.infoSpeak.out_video_cover+"&model_id="+this.infoSpeak.model_id+"&greet="+this.infoSpeak.share_desc}):uni.navigateTo({url:"/childCont/digital/history_digital?model_id="+this.infoSpeak.model_id}):uni.showModal({title:"提示",content:"请登录后查看",confirmText:"前往登录",showCancel:!1,success:function(e){e.confirm&&(uni.setStorageSync("userInfo",""),uni.navigateTo({url:"/pages/login/login"}))}})},getImgUrl:function(t){return e.baseImg+"/"+t},toTop:function(){uni.createSelectorQuery().select("#pag_top").boundingClientRect((function(e){console.log("进来了",e),uni.pageScrollTo({duration:100,scrollTop:100})})).exec()},playVideo:function(){this.videoContext_no.stop(),this.videoContext.play(),this.img_index=8,this.no_index=7,this.y_index=9,this.yLoad=!0,console.log("kaishi")},toPlayN:function(){console.log(this.noLoad,774),this.noLoad&&(this.noLoad=!1,this.img_index=8,this.no_index=9,this.y_index=7)},playOne:function(){this.isone=!this.isone,this.isone?this.videoContext.pause():this.videoContext.play()},toPlayY:function(){console.log(this.yLoad,"动态2222"),this.yLoad&&(this.yLoad=!1,this.img_index=8,this.no_index=7,this.y_index=9)},oneEnd:function(){this.videoContext.stop(),this.videoContext_no.play(),this.noLoad=!0,this.img_index=8,this.no_index=9,this.y_index=7},playSpeak:function(){this.getInteract(),this.videoContext_no.stop(),this.ySpeakLoad=!0,this.is_click=!0},speakOne:function(){this.getInteract(),this.innerAudioContext.pause(),this.videoContext.pause(),this.is_click=!0},message:function(){this.messageShow=!0},messageSubmit:function(){var e=this;if(""==this.messageValue)return this.$api.msg("请输入留言内容");if(""==this.messagePhone)return this.$api.msg("请输入联系方式");var t=JSON.parse(uni.getStorageSync("userInfo")),i={model_id:this.infoSpeak.model_id,user_id:t.user_id,content:this.messageValue,user_mobile:this.messagePhone};(0,r.creatMessage)(i).then((function(t){2e4==t.code?(e.$api.msg("留言成功"),e.messageShow=!1):e.$api.msg(t.msg)})).catch((function(t){e.$api.msg("留言失败")}))},toPhone:function(e){uni.makePhoneCall({phoneNumber:e})},checkInfo:function(e){this.tipShow=!0,this.top_tip=e},copyWebsite:function(e){wx.setClipboardData({data:e,success:function(){uni.showToast({title:"复制成功"})}})}}),o);t.default=g}).call(this,i("c8ba"))},be94:function(e,t,i){"use strict";i.r(t);var n=i("0638"),o=i("3674");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("8b42"),i("848c");var s=i("f0c5"),c=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"5d8e5a9d",null,!1,n["a"],void 0);t["default"]=c.exports},d459:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,".a1[data-v-5d8e5a9d],\n.b2[data-v-5d8e5a9d]{height:100%}.container-fill[data-v-5d8e5a9d]{height:100vh;overflow:hidden}.scroll-fullpage[data-v-5d8e5a9d]{transition:all .8s;height:100vh}.digital[data-v-5d8e5a9d]{width:100vw;position:relative}.digital > uni-image[data-v-5d8e5a9d]{width:100%;height:100%}.digital .top-nav[data-v-5d8e5a9d]{align-items:center;border-radius:4px;display:inline-block;position:absolute;left:%?20?%;top:%?20?%;z-index:10;display:flex}.digital .top-nav > uni-view[data-v-5d8e5a9d]{padding:%?20?%;background:rgba(0,0,0,.6)}.digital .top-nav > uni-view[data-v-5d8e5a9d]{display:flex;flex-direction:column;justify-content:center}.digital .top-nav > uni-view uni-image[data-v-5d8e5a9d]{width:%?32?%;height:%?32?%;position:relative;left:50%;-webkit-transform:translate(-50%);transform:translate(-50%)}.digital .top-nav > uni-view uni-text[data-v-5d8e5a9d]{color:#fff;font-size:12px;font-style:normal;font-weight:400;line-height:20px\n  /* 166.667% */}.digital .right-nav[data-v-5d8e5a9d]{position:absolute;right:%?18?%;top:50%;z-index:10;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.digital .right-nav > uni-view[data-v-5d8e5a9d]{margin-bottom:%?16.5?%;display:flex;flex-direction:column;justify-content:center}.digital .right-nav > uni-view uni-image[data-v-5d8e5a9d]{position:relative;left:50%;-webkit-transform:translate(-50%);transform:translate(-50%);width:%?54?%;height:%?54?%}.digital .right-nav > uni-view uni-text[data-v-5d8e5a9d]{color:#fff;font-size:12px;font-style:normal;font-weight:400;line-height:20px;\n  /* 166.667% */text-align:center}.home[data-v-5d8e5a9d]{min-height:100vh;overflow:hidden}.video_w[data-v-5d8e5a9d]{width:100%;height:100vh;position:absolute}",""]),e.exports=t},ebbf:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,"uni-page-body[data-v-5d8e5a9d]{background:#f6f8fb}body.?%PAGE?%[data-v-5d8e5a9d]{background:#f6f8fb}",""]),e.exports=t},f40b:function(e,t,i){var n=i("d459");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=i("4f06").default;o("3bca26a1",n,!0,{sourceMap:!1,shadowMode:!1})}}]);